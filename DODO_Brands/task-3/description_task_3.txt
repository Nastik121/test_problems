Задание 3
Проверяемая компетенция
знание sql
Формат решения
вставьте текст запроса в рамку

Задание:
В нашей компании замеряется такой показатель, как “30-дневная активная база”. Для любого дня - это число клиентов за предыдущие 30 дней. (Например, для 2022-01-01 - это число уникальных клиентов, совершивших визит за 30 дней до 2022-01-01, включая 2022-01-01. Для 2022-01-02 - это число уникальных клиентов, совершивших визит за 30 дней до 2022-01-02, включая 2022-01-02 и т.д.)
Допустим у вас есть таблица с чековыми данными по двум городам со следующими полями: cityname - наименование города, date - дата чека, orderid - id чека, clientid - id клиента, sales - сумма чека в рублях
Данные в таблице с 2022-01-01 по 2022-06-30.
Сэмпл данных доступен по ссылке ниже.
Посчитайте подневную динамику 30-дневной активной базы по каждому городу, отсортируйте по городу и дате по возрастанию.
Пример результирующей таблицы:
cityname
date
active_base
city1
2022-02-01
534
…
…
…
city1
2022-06-30
976
city2
2022-02-01
3450
…
…
…
city2
2022-06-30
4210




